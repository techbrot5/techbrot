<!DOCTYPE html>
<html data-bs-theme="light" lang="en">

<head>
    <meta charset="utf-8">
<meta name="keywords" content="Certified QuickBooks ProAdvisor, QuickBooks support, QBO help, QuickBooks setup, bookkeeping services, QuickBooks cleanup, QuickBooks file review, QuickBooks hosting, QuickBooks migration, QuickBooks consultation">
<meta name="robots" content="index, follow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">



<!-- Floating Contact Us Button -->
<button id="contactUsBtn" class="contact-button" aria-label="Contact Us">
    <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" style="margin-right: 5px; vertical-align: middle;">
        <path d="M2 4V12C2 12.55 2.45 13 3 13H11L14 16V3C14 2.45 13.55 2 13 2H3C2.45 2 2 2.45 2 3V4Z" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>
    Contact Us
</button>

<!-- Contact Popup -->
<div id="contactPopup" class="contact-popup hidden" role="dialog" aria-labelledby="popupHeader">
    <button id="closePopup" class="popup-close" aria-label="Close Contact Options">
        √ó
    </button>
    <div id="popupHeader" class="popup-header">How can we help?</div>
    <div class="popup-subheader">Sales & Customer Service: <a href="tel:8777515575">877-751-5575</a></div>
    <div class="popup-hours">Open all days, 24/7</div>
    <div class="popup-actions">
        <button id="scheduleCall" class="popup-button" aria-label="Schedule a Call">Schedule Now</button>
        <a href="/insight/" class="popup-button secondary" aria-label="Visit Support Page">Visit Support Page</a>
    </div>
</div>

<!-- Styles -->
<style>
    /* Floating Contact Us Button */
    .contact-button {
        position: fixed;
        bottom: 14px;
        right: -100px; /* Start off-screen */
        background: #007bff;
        color: white;
        padding: 12px 24px;
        border: none;
        border-radius: 25px;
        cursor: pointer;
        transition: right 0.6s ease-in-out, background 0.3s;
        display: flex;
        align-items: center;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        font-size: 16px;
        font-weight: 500;
    }
    .contact-button:hover {
        background: #0056b3;
    }
    .contact-button.show {
        right: 70px; /* Slide into view */
    }

    /* Contact Popup */
    .contact-popup {
        position: fixed;
        bottom: 80px;
        right: 20px;
        background: white;
        padding: 20px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        border-radius: 8px;
        width: 300px;
        opacity: 0;
        transform: translateY(20px);
        transition: opacity 0.4s ease-in-out, transform 0.4s ease-in-out, visibility 0.4s;
        visibility: hidden;
    }

    .contact-popup.show {
        opacity: 1;
        transform: translateY(0);
        visibility: visible;
    }

    /* Close Button */
    .popup-close {
        background: none;
        border: none;
        cursor: pointer;
        position: absolute;
        top: 10px;
        right: 10px;
        font-size: 18px;
        color: #888;
    }
    .popup-close:hover {
        color: #333;
    }

    /* Popup Header */
    .popup-header {
        font-weight: bold;
        margin-bottom: 10px;
        font-size: 18px;
    }

    /* Popup Buttons */
    .popup-button {
        display: block;
        margin-top: 12px;
        background: #007bff;
        color: white;
        text-decoration: none;
        padding: 10px;
        text-align: center;
        border-radius: 5px;
        cursor: pointer;
        transition: background 0.3s;
        font-size: 14px;
        font-weight: 500;
        border: none;
        width: 100%;
    }
    .popup-button:hover {
        background: #0056b3;
    }

    .popup-button.secondary {
        background: #f1f1f1;
        color: #333;
    }
    .popup-button.secondary:hover {
        background: #ddd;
    }
</style>

<!-- JavaScript -->
<script>
    document.addEventListener("DOMContentLoaded", function() {
        // Slide-in animation for Contact Us button
        setTimeout(() => {
            document.getElementById("contactUsBtn").classList.add("show");
        }, 200);
    });

    // Toggle Contact Popup
    document.getElementById("contactUsBtn").addEventListener("click", function() {
        document.getElementById("contactPopup").classList.toggle("show");
    });

    // Close Popup
    document.getElementById("closePopup").addEventListener("click", function() {
        document.getElementById("contactPopup").classList.remove("show");
    });

    // Open Consultation Modal when "Schedule Now" is clicked
    document.getElementById("scheduleCall").addEventListener("click", function() {
        document.getElementById("contactPopup").classList.remove("show"); // Hide the popup
        showModal(); // Open the existing consultation modal
    });
</script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <title>Payment Successful | QuickBooks Support &amp; Bookkeeping Confirmed</title>
    <meta name="description" content="Thank you for your payment! Your QuickBooks setup or bookkeeping service has been confirmed. A Certified ProAdvisor will contact you soon.">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="../assets/css/bootstrap-icons.css">
    <link rel="stylesheet" href="../assets/css/Lato.css">
    <link rel="stylesheet" href="../assets/css/swiper-icons.css">
    <link rel="stylesheet" href="../assets/css/pricing.css">
    <link rel="stylesheet" href="../assets/css/vendor/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="../assets/css/vendor/bootstrap-icons/bootstrap-icons.css">
    <link rel="stylesheet" href="../assets/css/vendor/swiper/swiper-bundle.min.css">
    <link rel="stylesheet" href="../assets/css/css/main.css">
    <link rel="stylesheet" href="../assets/css/style-2.css">
    <link rel="stylesheet" href="../assets/css/checkout.css">
    <link rel="stylesheet" href="../assets/css/contact-banner.css">
    <link rel="stylesheet" href="../assets/css/faq.css">
    <link rel="stylesheet" href="../assets/css/live-pricing.css">
<!-- ‚úÖ Global Consultation Modal -->
<div id="consultationModal" class="consultation-modal" style="display:none;">
  <button type="button" class="close-btn" onclick="hideModal()">√ó</button>
  <h2>Schedule a Free Consultation</h2>
  <p>Talk with a specialist for help choosing a QuickBooks product. Schedule a callback at your convenience.</p>

  <form method="post" enctype="application/x-www-form-urlencoded" id="consultationForm">
    <input type="hidden" name="form_id" value="US_QBOAV_b86ead92-354b-474d-829a-01be8d5c33b4">
    <input type="hidden" name="lead_country" value="US">

    <div class="input-container"><input type="text" name="full_name" required><label>Full name*</label></div>
    <div class="input-container"><input type="email" name="email" required><label>Email*</label></div>
    <div class="input-container"><input type="tel" name="phone" required><label>Phone*</label></div>

    <button type="submit" class="submit-btn">Schedule Now</button>

    <p class="disclaimer">
      By clicking ‚ÄúSchedule,‚Äù you agree to permit Intuit to contact you regarding QuickBooks and have read and acknowledge our
      <a href="https://www.intuit.com/privacy/" target="_blank">Privacy Statement</a>. Consent is not a condition of any purchase.
    </p>
  </form>
</div>

<!-- Overlay -->
<div id="overlay" class="overlay" onclick="hideModal()"></div>

<!-- ‚úÖ Modal Styles -->
<style>
  .consultation-modal {
    position: fixed;
    top: 50%; left: 50%;
    transform: translate(-50%, -50%);
    background: #fff;
    padding: 25px;
    border-radius: 6px;
    box-shadow: 0 4px 10px rgba(0,0,0,0.3);
    z-index: 1001;
    width: 90%;
    max-width: 420px;
    text-align: center;
  }
  .overlay {
    position: fixed; top: 0; left: 0;
    width: 100%; height: 100%;
    background: rgba(0,0,0,0.5);
    z-index: 1000;
    display: none;
  }
  .close-btn {
    position: absolute; top: 10px; right: 12px;
    border: none; background: none; font-size: 22px;
    cursor: pointer; color: #333;
  }
  .submit-btn {
    background: #0a8543; color: #fff;
    width: 100%; padding: 12px; border: none;
    border-radius: 4px; font-size: 16px;
    cursor: pointer; transition: background 0.3s;
  }
  .submit-btn:hover { background: #28a745; }
  .disclaimer { font-size: 12px; color: #777; margin-top: 10px; }
  .disclaimer a { color: #0a8543; text-decoration: none; }
  .spinner {
    display: inline-block; width: 14px; height: 14px;
    border: 2px solid white; border-top: 2px solid transparent;
    border-radius: 50%; animation: spin 0.6s linear infinite;
    margin-left: 5px;
  }
  @keyframes spin { to { transform: rotate(360deg); } }
</style><meta name="robots" content="noindex, nofollow">
<link rel="canonical" href="https://techbrot.com/support/success.html">
</head>

<body><!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Thank you ‚Äî Order received</title>
  <!-- Bootstrap 5 -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Inter -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
  <style>
    /* Layout & theme inspired by your cancel page but tuned for a light success page */
    :root{
      --surface:#ffffff;
      --muted:#6c757d;
      --accent:#0ea5a4;
      --accent-dark:#06b6d4;
      --success:#16a34a;
      --danger:#ef4444;
      --card-shadow: 0 8px 30px rgba(18,38,63,0.06);
      font-family: "Inter", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }

    html,body{height:100%;margin:0}
    body{
      background: linear-gradient(180deg,#f6f9fb 0%, #ffffff 100%);
      min-height:100vh;
      -webkit-font-smoothing:antialiased;
      padding:28px;
      display:flex; align-items:center; justify-content:center;
      color: #0b1220;
    }

    .container-lg{ max-width:1100px; width:100%; }

    /* Main card */
    .card-hero{
      border:0;
      border-radius:14px;
      background:var(--surface);
      box-shadow: var(--card-shadow);
      overflow:visible;
      transition: opacity 600ms ease, transform 420ms ease;
      opacity: 0;
      transform: translateY(6px);
    }
    .card-hero.visible{ opacity:1; transform: translateY(0); }

    .kicker{
      display:inline-flex; gap:.5rem; align-items:center;
      background: linear-gradient(90deg,var(--accent-dark),var(--accent));
      color:white; padding:6px 10px; border-radius:999px; font-weight:700; font-size:13px;
      box-shadow: 0 8px 22px rgba(14,165,164,0.08);
    }

    h1{ font-size:1.6rem; margin:.25rem 0 .2rem; letter-spacing:-.01em; }
    p.lead{ margin-bottom:1rem; color:var(--muted); }

    .order-badge{
      width:84px; height:84px; border-radius:12px;
      display:flex; align-items:center; justify-content:center;
      background: linear-gradient(180deg,#e6fffa,#ecfeff);
      color:var(--accent-dark); font-weight:800; font-size:28px;
      border:1px solid rgba(14,165,164,0.08);
    }

    .summary-card{ border-radius:12px; border:1px solid rgba(17,24,39,0.04); background:#fff; box-shadow:0 6px 18px rgba(12,22,46,0.03); }

    .line-item{ display:flex; justify-content:space-between; gap:12px; padding:10px 0; border-bottom:1px solid rgba(0,0,0,0.04); }
    .muted{ color:var(--muted); }
    .total-amount{ font-weight:700; font-size:1.05rem; color:var(--success); }

    .btn-download{ background:linear-gradient(90deg,var(--accent-dark),var(--accent)); color:white; border:0; }
    .btn-ghost{ background:transparent; border:1px solid rgba(0,0,0,0.06); color:#333; }

    /* Responsive layout */
    @media (min-width: 992px){
      .layout-grid{ display:grid; grid-template-columns: 1fr 360px; gap:24px; align-items:start; }
      .summary-card{ align-self:start; }
    }
    @media (max-width:991px){
      .layout-grid{ display:block; }
    }

    /* Receipt preview */
    #receiptForPdf{ background:#fff; padding:20px; border-radius:8px; color:#111; font-size:14px; line-height:1.45; }
    #receiptForPdf h2{ margin:0 0 .25rem; font-size:18px; }
    #receiptForPdf .meta-row{ display:flex; justify-content:space-between; gap:12px; font-size:13px; color:#444; margin-bottom:8px; flex-wrap:wrap; }
    #receiptForPdf table{ width:100%; border-collapse:collapse; margin-top:12px; }
    #receiptForPdf th,#receiptForPdf td{ padding:8px 6px; text-align:left; border-bottom:1px solid #eee; font-size:13px; }
    #receiptForPdf tfoot td{ font-weight:700; border-top:2px solid #ddd; }

    /* Confetti canvas overlay */
    #confetti{ position:fixed; left:0; top:0; width:100%; height:100%; pointer-events:none; z-index:1050; }

    /* Small tweaks */
    @media (max-width:600px){
      .order-badge{ width:64px; height:64px; font-size:22px; }
      .card-hero{ padding:18px; }
      #receiptForPdf{ padding:12px; }
    }

    /* Accessibility focus */
    .btn:focus, .btn-ghost:focus { outline:3px solid rgba(14,165,164,0.12); outline-offset:3px; border-radius:8px; }

    /* Small print helper */
    .no-print { -webkit-print-color-adjust: exact; }
  </style>
</head>
<body>
  <!-- Confetti canvas -->
  <canvas id="confetti" aria-hidden="true"></canvas>
  <main class="container-lg">
    <div id="mainContent" class="card card-hero p-4 layout-grid" role="main" aria-labelledby="thankHeading">
      <!-- LEFT -->
      <section>
        <div class="d-flex align-items-start gap-3 mb-2">
          <div class="kicker">Order complete</div>
          <small class="ms-auto muted no-print" id="timeNote"></small>
        </div>
    <div class="d-flex gap-3 align-items-center mb-2">
      <div class="order-badge" id="orderEmoji">üéâ</div>
      <div class="flex-grow-1">
        <h1 id="thankHeading">Thanks ‚Äî your order is confirmed</h1>
        <p class="lead" id="subLead">We've received your order. A receipt has been emailed. You can also download a PDF receipt below.</p>
        <div class="muted" id="contactRow">Questions? Email <a href="mailto:orders@example.com" id="contactEmail">orders@example.com</a>.</div>
      </div>
    </div>

    <div id="receiptForPdf" aria-labelledby="receipt-heading">
      <div class="d-flex justify-content-between align-items-start">
        <div>
          <h2 id="merchantName">Your Company, Inc.</h2>
          <div class="muted">orders@example.com ¬∑ +1 (555) 555-5555</div>
        </div>
        <div class="text-end">
          <div class="muted">Receipt</div>
          <div id="pdfOrderId" style="font-weight:700; font-size:16px;">‚Äî</div>
          <div id="pdfDate" class="muted" style="margin-top:6px;">‚Äî</div>
        </div>
      </div>

      <div style="margin-top:14px;">
        <div class="meta-row">
          <div>
            <strong id="pdfCustomerName">Customer</strong>
            <div id="pdfCustomerEmail" class="muted"></div>
          </div>
          <div class="muted text-end">
            <div>Payment method: <span id="pdfPaymentMethod">Card</span></div>
            <div id="pdfSessionId">Session: ‚Äî</div>
          </div>
        </div>

        <table id="pdfItems" aria-describedby="pdfItemSummary">
          <thead>
            <tr><th>Item</th><th class="text-end">Unit</th><th class="text-end">Qty</th><th class="text-end">Total</th></tr>
          </thead>
          <tbody id="pdfItemsBody">
            <tr><td colspan="4" class="muted text-center py-3">No items found</td></tr>
          </tbody>
          <tfoot>
            <tr><td colspan="3" class="text-end muted">Subtotal</td><td id="pdfSubtotal" class="text-end">$0.00</td></tr>
            <tr><td colspan="3" class="text-end muted">Tax</td><td id="pdfTax" class="text-end">$0.00</td></tr>
            <tr><td colspan="3" class="text-end">Total</td><td id="pdfTotal" class="text-end total-amount">$0.00</td></tr>
          </tfoot>
        </table>

        <div class="muted" style="margin-top:12px; font-size:13px;">
          Order notes: <span id="pdfNotes">‚Äî</span>
        </div>
      </div>
    </div>

    <div class="mt-3 muted small">Order ID and receipt are generated in your browser. If you prefer a server-generated invoice, contact support.</div>
  </section>

  <!-- RIGHT -->
  <aside class="summary-card p-3">
    <h5 class="mb-2">Order summary</h5>
    <div id="summaryLines" class="mb-2">
      <div class="line-item">
        <div>
          <strong id="summaryItem">Item</strong>
          <div class="muted small" id="summaryDesc"></div>
        </div>
        <div id="summaryPrice" class="muted">$0.00</div>
      </div>
    </div>

    <div class="d-flex justify-content-between align-items-center mt-2 mb-2">
      <div class="muted">Total</div>
      <div class="total-amount" id="summaryTotal">$0.00</div>
    </div>

    <div class="d-grid gap-2 mt-3">
      <button id="downloadReceiptBtn" class="btn btn-download btn-lg no-print" aria-label="Download receipt as PDF">‚¨áÔ∏è Download receipt (PDF)</button>
      <button id="openReceiptViewBtn" class="btn btn-ghost no-print">View receipt (printer-friendly)</button>
      <a href="/quickbooks/service-plans/index.html" class="btn btn-outline-secondary no-print">Back to plans</a>
    </div>

    <div class="muted small mt-3" id="metaNote">You may close this page. A copy of the receipt was sent to your email.</div>
  </aside>
</div>

  </main>
  <!-- html2pdf (client-side PDF generation) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.3/html2pdf.bundle.min.js"></script>
  <script>
  /* Full client-side logic ‚Äî confetti single burst, reveal after burst, receipt render, PDF & print */
  (function () {
    'use strict';

    // Config
    const CONFETTI_SHOW_MS = 5500; // how long confetti is visible before revealing UI

    // Utilities
    const qs = (s, ctx=document) => (ctx||document).querySelector(s);
    const money = n => '$' + Number(n || 0).toLocaleString(undefined, { minimumFractionDigits:2, maximumFractionDigits:2 });
    const param = name => (new URL(window.location.href)).searchParams.get(name) || '';
    const readJSON = (k) => { try { return JSON.parse(localStorage.getItem(k) || 'null'); } catch (e) { return null; } };

    // DPR-aware canvas
    function setupCanvas(canvas) {
      if (!canvas) return null;
      const ctx = canvas.getContext('2d');
      const DPR = Math.max(1, window.devicePixelRatio || 1);
      function resize() {
        canvas.width = Math.floor(window.innerWidth * DPR);
        canvas.height = Math.floor(window.innerHeight * DPR);
        canvas.style.width = window.innerWidth + 'px';
        canvas.style.height = window.innerHeight + 'px';
        ctx.setTransform(DPR, 0, 0, DPR, 0, 0);
      }
      resize();
      window.addEventListener('resize', resize, { passive: true });
      return { canvas, ctx, DPR };
    }

    // One-time confetti burst (returns handle with stop())
    function burstConfettiOnce(opts = {}) {
      const canvas = qs('#confetti');
      if (!canvas) return null;
      const s = setupCanvas(canvas);
      if (!s) return null;
      const ctx = s.ctx;
      const rand = (a,b) => Math.random()*(b-a)+a;
      const colors = opts.colors || ['#06b6d4','#0ea5a4','#60a5fa','#f472b6','#f59e0b','#10b981'];
      const count = opts.count || 60;
      const particles = [];
      for (let i=0;i<count;i++){
        particles.push({
          x: window.innerWidth/2 + rand(-180,180),
          y: window.innerHeight/3 + rand(-80,80),
          vx: rand(-8,8),
          vy: rand(-10,2),
          size: Math.floor(rand(6,14)),
          rot: rand(0,Math.PI*2),
          vr: rand(-0.12,0.12),
          color: colors[Math.floor(rand(0,colors.length))],
          ttl: Math.floor(rand(60,220))
        });
      }

      let running = true;
      function draw(){
        ctx.clearRect(0,0,window.innerWidth,window.innerHeight);
        let alive = 0;
        for (let p of particles){
          if (p.ttl <= 0) continue;
          p.x += p.vx; p.y += p.vy; p.vy += 0.12; p.rot += p.vr; p.ttl--;
          ctx.save();
          ctx.translate(p.x,p.y);
          ctx.rotate(p.rot);
          ctx.fillStyle = p.color;
          ctx.fillRect(-p.size/2, -p.size/2, p.size, p.size);
          ctx.restore();
          if (p.ttl>0 && p.y < window.innerHeight+80) alive++;
        }
        if (alive && running) requestAnimationFrame(draw);
        else ctx.clearRect(0,0,window.innerWidth,window.innerHeight);
      }
      draw();
      return { stop(){ running=false; try{ ctx.clearRect(0,0,window.innerWidth,window.innerHeight); }catch(e){} } };
    }

    // Order ID helpers
    function nextOrderSequence() {
      try {
        const key = 'order_seq';
        let seq = Number(localStorage.getItem(key) || 0);
        seq = (isNaN(seq) ? 0 : seq) + 1;
        localStorage.setItem(key, String(seq));
        return seq;
      } catch (e) {
        return Math.floor(Math.random()*900000+100000);
      }
    }
    function formatOrderId(seq) {
      const d = new Date();
      const YYYY = d.getFullYear();
      const MM = String(d.getMonth()+1).padStart(2,'0');
      const DD = String(d.getDate()).padStart(2,'0');
      const seqStr = String(seq).padStart(4,'0');
      return `ORD-${YYYY}${MM}${DD}-${seqStr}`;
    }

    // Build receipt model (from URL params or localStorage)
    const seq = nextOrderSequence();
    const orderId = param('order') || param('order_id') || param('orderId') || formatOrderId(seq);
    const sessionId = param('session_id') || param('session') || param('sessionId') || '';
    const checkoutId = param('checkout_id') || param('checkout') || '';
    const amountParam = param('amount') || param('total') || param('price') || '';
    const nameParam = decodeURIComponent(param('name') || param('customer') || '').replace(/\+/g,' ').trim();
    const emailParam = decodeURIComponent(param('email') || '').replace(/\+/g,' ').trim();
    const itemParam = decodeURIComponent(param('item') || '').replace(/\+/g,' ').trim();

    const receipt = {
      orderId,
      createdAt: new Date(),
      sessionId: sessionId || checkoutId || '',
      customerName: nameParam || 'Valued customer',
      customerEmail: emailParam || '',
      paymentMethod: param('pm') || param('payment_method') || 'Card',
      items: [],
      subtotal: 0,
      tax: 0,
      total: 0,
      notes: ''
    };

    (function populate(){
      if (amountParam) {
        const n = parseFloat(String(amountParam).replace(/[^0-9.]/g,'')) || 0;
        receipt.items = [{ label: itemParam || 'Purchase', unit: n, qty: 1, total: n }];
        receipt.subtotal = n; receipt.total = n; return;
      }
      const sp = readJSON('service_plans_cart');
      if (Array.isArray(sp) && sp.length) {
        receipt.items = sp.map(it => {
          const price = Number(it.price||0); const qty = Number(it.quantity||1);
          const lbl = it.productName || it.product || it.label || it.name || 'Item';
          return { label: lbl, unit: price, qty, total: price*qty, billing: it.billing||'' };
        });
        receipt.subtotal = receipt.items.reduce((s,i)=> s + (i.total||0), 0);
        receipt.total = receipt.subtotal; return;
      }
      const pc = readJSON('pricing_cart');
      if (Array.isArray(pc) && pc.length) {
        receipt.items = pc.map(it => {
          const price = Number(it.price||0); const qty = Number(it.quantity||1);
          const lbl = it.product || it.plan || it.option || 'Item';
          return { label: lbl, unit: price, qty, total: price*qty, billing: it.billing||'' };
        });
        receipt.subtotal = receipt.items.reduce((s,i)=> s + (i.total||0), 0);
        receipt.total = receipt.subtotal; return;
      }
      // fallback
      receipt.items = [{ label: itemParam || 'Service plan', unit:0, qty:1, total:0 }];
      receipt.subtotal = 0; receipt.total = 0;
    })();

    const taxPercent = Number(param('tax') || 0);
    if (taxPercent > 0) { receipt.tax = +(receipt.subtotal * (taxPercent/100)); receipt.total = +(receipt.subtotal + receipt.tax); }
    else { receipt.tax = 0; receipt.total = receipt.total || receipt.subtotal; }

    // Render to DOM
    function renderPreview(){
      const setText = (sel, txt) => { const el = qs(sel); if (el) el.textContent = txt; };
      setText('#pdfOrderId', receipt.orderId);
      setText('#pdfDate', receipt.createdAt.toLocaleString());
      setText('#pdfCustomerName', receipt.customerName || 'Customer');
      setText('#pdfCustomerEmail', receipt.customerEmail || '');
      setText('#pdfPaymentMethod', receipt.paymentMethod || 'Card');
      setText('#pdfSessionId', receipt.sessionId ? ('Session: ' + receipt.sessionId) : '');

      const tbody = qs('#pdfItemsBody');
      if (tbody) {
        tbody.innerHTML = '';
        if (!receipt.items || !receipt.items.length) {
          tbody.innerHTML = '<tr><td colspan="4" class="muted text-center py-3">No items found</td></tr>';
        } else {
          receipt.items.forEach(it => {
            const tr = document.createElement('tr');
            const td1 = document.createElement('td'); td1.textContent = it.label + (it.billing ? ' ¬∑ ' + it.billing : '');
            const td2 = document.createElement('td'); td2.className = 'text-end'; td2.textContent = money(it.unit);
            const td3 = document.createElement('td'); td3.className = 'text-end'; td3.textContent = String(it.qty || 1);
            const td4 = document.createElement('td'); td4.className = 'text-end'; td4.textContent = money(it.total);
            tr.append(td1, td2, td3, td4);
            tbody.appendChild(tr);
          });
        }
      }
      setText('#pdfSubtotal', money(receipt.subtotal));
      setText('#pdfTax', money(receipt.tax));
      setText('#pdfTotal', money(receipt.total));
      setText('#summaryItem', (receipt.items[0] && receipt.items[0].label) || 'Item');
      setText('#summaryDesc', (receipt.items[0] && receipt.items[0].billing) ? receipt.items[0].billing : '');
      setText('#summaryPrice', money(receipt.total));
      setText('#summaryTotal', money(receipt.total));
      const emoji = qs('#orderEmoji'); if (emoji) emoji.textContent = (receipt.total > 0) ? '‚úÖ' : 'üéâ';
      const metaNote = qs('#metaNote'); if (metaNote) metaNote.textContent = 'A receipt has been emailed to ' + (receipt.customerEmail || 'your email address') + '.';
      const timeNote = qs('#timeNote'); if (timeNote) timeNote.textContent = 'Generated: ' + receipt.createdAt.toLocaleString();
      const pdfNotes = qs('#pdfNotes'); if (pdfNotes) pdfNotes.textContent = receipt.notes || (receipt.sessionId ? 'Checkout/session present' : '');
      const contactEmail = qs('#contactEmail'); if (contactEmail) contactEmail.href = 'mailto:orders@example.com';
    }

    // Show preview & run reveal/confetti
    renderPreview();
    const card = qs('.card-hero');
    if (card) card.style.display = '';

    let confettiHandle = null;
    try { confettiHandle = burstConfettiOnce(); } catch(e){ /* ignore */ }

    // Reveal UI after confetti duration
    setTimeout(() => {
      try { if (confettiHandle && typeof confettiHandle.stop === 'function') confettiHandle.stop(); } catch(e){}
      if (card) card.classList.add('visible');
    }, CONFETTI_SHOW_MS);

    // Download as PDF (html2pdf if present, else fallback to print popup)
    const downloadBtn = qs('#downloadReceiptBtn');
    if (downloadBtn) {
      downloadBtn.addEventListener('click', () => {
        downloadBtn.disabled = true;
        const now = new Date();
        const fileName = `${receipt.orderId.replace(/\s+/g,'_')}_receipt_${now.toISOString().slice(0,19).replace(/[:T]/g,'-')}.pdf`;
        const element = qs('#receiptForPdf');
        if (!element) { alert('Receipt element not available.'); downloadBtn.disabled = false; return; }

        // set exact generate time
        const pdfDateEl = qs('#pdfDate'); if (pdfDateEl) pdfDateEl.textContent = now.toLocaleString();

        if (typeof html2pdf === 'function') {
          const opt = {
            margin: [10,10,10,10],
            filename: fileName,
            image: { type: 'jpeg', quality: 0.98 },
            html2canvas: { scale: Math.min(2, window.devicePixelRatio || 1), useCORS: true, scrollY: -window.scrollY },
            jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
          };
          downloadBtn.textContent = 'Generating PDF‚Ä¶';
          setTimeout(() => {
            try {
              html2pdf().set(opt).from(element).save().then(() => {
                downloadBtn.disabled = false;
                downloadBtn.textContent = '‚¨áÔ∏è Download receipt (PDF)';
              }).catch(err => {
                console.error('PDF generation failed', err);
                alert('PDF generation failed. Try printing or contact support.');
                downloadBtn.disabled = false;
                downloadBtn.textContent = '‚¨áÔ∏è Download receipt (PDF)';
              });
            } catch (err) {
              console.error('PDF call failed', err);
              alert('PDF generation failed. Try printing or contact support.');
              downloadBtn.disabled = false;
              downloadBtn.textContent = '‚¨áÔ∏è Download receipt (PDF)';
            }
          }, 80);
        } else {
          // fallback to printable popup
          const popup = window.open('', '_blank', 'noopener');
          if (!popup) {
            alert('Popup blocked. Please allow popups or include html2pdf script to enable PDF download.');
            downloadBtn.disabled = false;
            return;
          }
          const title = `Receipt - ${receipt.orderId}`;
          const html = element.outerHTML;
          const docHtml = `<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>${title}</title><link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600,700&display=swap" rel="stylesheet"><style>body{font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;margin:24px;color:#111}table{width:100%;border-collapse:collapse}th,td{padding:8px;text-align:left;border-bottom:1px solid #eee}tfoot td{font-weight:700;border-top:2px solid #ddd}</style></head><body>${html}<script>window.print();<\/script></body></html>`;
      popup.document.open(); popup.document.write(docHtml); popup.document.close();
      downloadBtn.disabled = false;
    }
  });
}

// Printer-friendly view popup
const openBtn = qs('#openReceiptViewBtn');
if (openBtn) {
  openBtn.addEventListener('click', () => {
    const el = qs('#receiptForPdf');
    if (!el) { alert('Receipt not available'); return; }
    const html = el.outerHTML;
    const popup = window.open('', '_blank', 'noopener');
    if (!popup) { alert('Popup blocked. Allow popups to view receipt.'); return; }
    const title = `Receipt - ${receipt.orderId}`;
    const docHtml = `<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>${title}</title><link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600,700&display=swap" rel="stylesheet"><style>body{font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;margin:24px;color:#111}table{width:100%;border-collapse:collapse}th,td{padding:8px;text-align:left;border-bottom:1px solid #eee}tfoot td{font-weight:700;border-top:2px solid #ddd}</style></head><body>${html}<script>window.print();<\/script></body></html>`;
    popup.document.open(); popup.document.write(docHtml); popup.document.close();
  });
}

// Accessibility focus
setTimeout(() => {
  const h = qs('#thankHeading');
  if (h) { h.setAttribute('tabindex','-1'); h.focus(); }
}, 120);

// Small debug object (safe)
try { window._receiptDebug = { receipt, orderId, sessionId, checkoutId }; } catch (e) {}

// Log once
console.info('Receipt initialized', { orderId: receipt.orderId, items: receipt.items.length });

})();
</script>
</body>
</html>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.bundle.min.js"></script>
    <script src="../assets/js/bs-init.js"></script>
    <script src="../assets/js/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="../assets/js/vendor/php-email-form/validate.js"></script>
    <script src="../assets/js/vendor/aos/aos.js"></script>
    <script src="../assets/js/vendor/glightbox/js/glightbox.min.js"></script>
    <script src="../assets/js/vendor/swiper/swiper-bundle.min.js"></script>
    <script src="../assets/js/vendor/purecounter/purecounter_vanilla.js"></script>
    <script src="../assets/js/js/main.js"></script>
    <script src="../assets/js/faq-toggle.js"></script>
    <script src="../assets/js/feature-tabs.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js" type="module"></script>
    <script src="../assets/js/modal.js"></script>
</body>

</html>